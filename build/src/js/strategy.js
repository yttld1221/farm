"use strict";function strategy_info(){getPHP("src/php/query.php?sql=SELECT * FROM strategy").then(function(t){for(var n=JSON.parse(t),e="",s=0;s<n.length;s++)e+="   \n            <li>\n                <div>\n                    <a class='strategy_info' rel='"+s+"'  href=\"strategy_detail.html?id="+n[s].id+'"><img class="'+n[s].id+'" src="./src/img/strategy/'+n[s].img+"\" ></a>\n                </div>\n                <div>\n                    <a class='strategy_info' rel='"+s+"'  href=\"strategy_detail.html?id="+n[s].id+'">\n                        <p class="'+n[s].id+'">'+n[s].title+"</p>\n                    </a>\n                    <div>"+n[s].intro+"\n                    </div>\n                    <div>\n                        <span>"+n[s].time+'</span><i class="fa fa-eye fa"></i><span>'+n[s].num+"</span><span></span><span></span>\n                    </div>\n                </div>\n            </li>\n            ";$("#strategy_info").html(e),strategy_PageSize(),$("a.strategy_info").on("click",function(){var t=$(this).attr("href").split("=")[1],e=n[$(this).attr("rel")].num;null==window.sessionStorage.getItem("str_num"+t)&&(strategy_updatenum(t,e),window.sessionStorage.setItem("str_num"+t,e))})})}function strategy_PageSize(){$(function(){!function(t){var e=$(t.pageMain),n=$(t.pageNav),s=$(t.pagePrev),a=$(t.pageNext),i=t.curNum,r=Math.ceil(e.find(">li").length/i);console.log(r);for(var o="",l=0,g=0;g<r;g++)o+='<a href="javascript:;">'+(g+1)+"</a>";n.html(o),n.find("a:first").addClass("page-on"),n.find("a").each(function(){$(this).click(function(){n.find("a").removeClass("page-on"),$(this).addClass("page-on"),l=$(this).index(),$(e).find(">li").hide();for(var t=($(this).html()-1)*i;t<$(this).html()*i;t++)$(e).find(">li").eq(t).show()})}),$(e).find(">li").hide();for(var g=0;g<i;g++)$(e).find(">li").eq(g).show();a.click(function(){if($(e).find(">li").hide(),l==r-1){alert("已经是最后一页");for(var t=(r-1)*i;t<r*i;t++)$(e).find(">li").eq(t).show();return!1}n.find("a").removeClass("page-on"),l++,n.find("a").eq(l).addClass("page-on");for(var t=l*i;t<(l+1)*i;t++)$(e).find(">li").eq(t).show()}),s.click(function(){if($(e).find(">li").hide(),0==l){alert("当前是第一页");for(var t=0;t<i;t++)$(e).find(">li").eq(t).show();return!1}n.find("a").removeClass("page-on"),l--,n.find("a").eq(l).addClass("page-on");for(var t=l*i;t<(l+1)*i;t++)$(e).find(">li").eq(t).show()})}({pageMain:"#strategy_info",pageNav:"#pageNav",pagePrev:"#prev",pageNext:"#next",curNum:4,activeClass:"active",ini:0})})}function strategy_updatenum(t,e){e=parseInt(e)+1;getPHP("src/php/querya.php?sql="+("UPDATE strategy SET num ="+e+" WHERE id ="+t)).then(function(t){})}function strategy_search(){$(".act_search").on("click",function(){var t;null!=window.sessionStorage.getItem("str_search")?t=window.sessionStorage.getItem("str_search"):(t=$(".search_val").val(),window.sessionStorage.setItem("str_search",t)),getPHP("src/php/query.php?sql="+("SELECT * FROM strategy WHERE title LIKE '%"+t+"%'")).then(function(t){for(var n=JSON.parse(t),e="",s=0;s<n.length;s++)e+="   \n            <li>\n                <div>\n                    <a class='strategy_info' rel='"+s+"'  href=\"strategy_detail.html?id="+n[s].id+'"><img class="'+n[s].id+'" src="./src/img/strategy/'+n[s].img+"\" ></a>\n                </div>\n                <div>\n                    <a class='strategy_info' rel='"+s+"'  href=\"strategy_detail.html?id="+n[s].id+'">\n                        <p class="'+n[s].id+'">'+n[s].title+"</p>\n                    </a>\n                    <div>"+n[s].intro+"\n                    </div>\n                    <div>\n                        <span>"+n[s].time+'</span><i class="fa fa-eye fa"></i><span>'+n[s].num+"</span><span></span><span></span>\n                    </div>\n                </div>\n            </li>\n            ";$("#strategy_info").html(e),strategy_PageSize("#strategy_info"),$("a.strategy_info").on("click",function(){var t=$(this).attr("href").split("=")[1],e=n[$(this).attr("rel")].num;null==window.sessionStorage.getItem("str_num"+t)&&(strategy_updatenum(t,e),window.sessionStorage.setItem("str_num"+t,e))})})})}function strategy_input_color(){$(".search_val").on("focusin",function(){$(".search").css("border","1px solid greenyellow")}).on("focusout",function(){$(".search").css("border","1px solid gainsboro")})}function strategy_each_item(){getPHP("src/php/query.php?sql=SELECT * FROM strategy").then(function(t){for(var n=JSON.parse(t),e="",s=0;s<3;s++)e+=' \n            <li><a href="strategy_detail.html?id='+n[s].id+"\" rel='"+s+"'>"+n[s].title+"</a></li>\n            ";$(".echo_item").html(e),$(".echo_item a").on("click",function(){var t=$(this).attr("href").split("=")[1],e=n[$(this).attr("rel")].num;null==window.sessionStorage.getItem("str_num"+t)&&(strategy_updatenum(t,e),window.sessionStorage.setItem("str_num"+t,e))})})}function str_sea(){var t=window.sessionStorage.getItem("str_search");console.log(t),getPHP("src/php/query.php?sql="+("SELECT * FROM strategy WHERE title LIKE '%"+t+"%'")).then(function(t){var n=JSON.parse(t);console.log(n);for(var e="",s=0;s<n.length;s++)e+="   \n        <li>\n            <div>\n                <a class='strategy_info' rel='"+s+"'  href=\"strategy_detail.html?id="+n[s].id+'"><img class="'+n[s].id+'" src="./src/img/strategy/'+n[s].img+"\" ></a>\n            </div>\n            <div>\n                <a class='strategy_info' rel='"+s+"'  href=\"strategy_detail.html?id="+n[s].id+'">\n                    <p class="'+n[s].id+'">'+n[s].title+"</p>\n                </a>\n                <div>"+n[s].intro+"\n                </div>\n                <div>\n                    <span>"+n[s].time+'</span><i class="fa fa-eye fa"></i><span>'+n[s].num+"</span><span></span><span></span>\n                </div>\n            </div>\n        </li>\n        ";$("#strategy_info").html(e),strategy_PageSize("#strategy_info"),$("a.strategy_info").on("click",function(){var t=$(this).attr("href").split("=")[1],e=n[$(this).attr("rel")].num;null==window.sessionStorage.getItem("str_num"+t)&&(strategy_updatenum(t,e),window.sessionStorage.setItem("str_num"+t,e))})})}function clear_str(){$("#nav-uli a").on("click",function(){window.sessionStorage.removeItem("str_search")})}function str_display(){null!=window.sessionStorage.getItem("str_search")?str_sea():strategy_info()}strategy_search(),strategy_input_color(),strategy_each_item(),clear_str(),str_display();