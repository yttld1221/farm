"use strict";function activity_sea(){var i=window.sessionStorage.getItem("search");getPHP("src/php/query.php?sql="+("SELECT * FROM activity WHERE title LIKE '%"+i+"%'")).then(function(i){for(var e=JSON.parse(i),a="",t=0;t<e.length;t++)a+="   \n            <li>\n                <div>\n                    <a class='activity_search_info' rel='"+t+"'  href=\"activity_detail.html?id="+e[t].id+'"><img class="'+e[t].id+'" src="./src/img/activity/'+e[t].img+"\" ></a>\n                </div>\n                <div>\n                    <a class='activity_search_info' rel='"+t+"'  href=\"activity_detail.html?id="+e[t].id+'">\n                        <p class="'+e[t].id+'">'+e[t].title+"</p>\n                    </a>\n                    <div>"+e[t].intro+"\n                    </div>\n                    <div>\n                        <span>"+e[t].time+'</span><i class="fa fa-eye fa"></i><span>'+e[t].num+"</span><span></span><span></span>\n                    </div>\n                </div>\n            </li>\n            ";$("#activity_search_info").html(a),sea_activity_PageSize("#activity_search_info"),$("#activity_search_info a.activity_search_info").on("click",function(){var i=$(this).attr("href").split("=")[1],a=e[$(this).attr("rel")].num;null==window.sessionStorage.getItem("act_num"+i)&&(sea_updatenum(i,a),window.sessionStorage.setItem("act_num"+i,a))}),window.sessionStorage.removeItem("search")})}function sea_activity_PageSize(i){$(function(){!function(i){var a=$(i.pageMain),e=$(i.pageNav),t=$(i.pagePrev),n=$(i.pageNext),s=i.curNum,c=Math.ceil(a.find(">li").length/s);console.log(c);for(var r="",o=0,l=0;l<c;l++)r+='<a href="javascript:;">'+(l+1)+"</a>";e.html(r),e.find("a:first").addClass("page-on"),e.find("a").each(function(){$(this).click(function(){e.find("a").removeClass("page-on"),$(this).addClass("page-on"),o=$(this).index(),$(a).find(">li").hide();for(var i=($(this).html()-1)*s;i<$(this).html()*s;i++)$(a).find(">li").eq(i).show()})}),$(a).find(">li").hide();for(var l=0;l<s;l++)$(a).find(">li").eq(l).show();n.click(function(){if($(a).find(">li").hide(),o==c-1){alert("已经是最后一页");for(var i=(c-1)*s;i<c*s;i++)$(a).find(">li").eq(i).show();return!1}e.find("a").removeClass("page-on"),o++,e.find("a").eq(o).addClass("page-on");for(var i=o*s;i<(o+1)*s;i++)$(a).find(">li").eq(i).show()}),t.click(function(){if($(a).find(">li").hide(),0==o){alert("当前是第一页");for(var i=0;i<s;i++)$(a).find(">li").eq(i).show();return!1}e.find("a").removeClass("page-on"),o--,e.find("a").eq(o).addClass("page-on");for(var i=o*s;i<(o+1)*s;i++)$(a).find(">li").eq(i).show()})}({pageMain:i,pageNav:"#pageNav",pagePrev:"#prev",pageNext:"#next",curNum:4,activeClass:"active",ini:0})})}function sea_updatenum(i,a){a=parseInt(a)+1;getPHP("src/php/querya.php?sql="+("UPDATE activity SET num ="+a+" WHERE id ="+i)).then(function(i){})}function sea_activity_search(){$(".act_search").on("click",function(){var i=$(".search_val").val();window.sessionStorage.setItem("search",i),$(this).parent().attr("href","activity_search.html?title="+i)})}function sea_input_color(){$(".search_val").on("focusin",function(){$(".search").css("border","1px solid greenyellow")}).on("focusout",function(){$(".search").css("border","1px solid gainsboro")})}function sea_each_item(){getPHP("src/php/query.php?sql=SELECT * FROM activity").then(function(i){for(var e=JSON.parse(i),a="",t=Math.ceil(12*Math.random()),n=0;n<4;t+=2,n++)a+=' \n            <li><a href="activity_detail.html?id='+e[t].id+"\" rel='"+t+"'>"+e[t].title+"</a></li>\n            ";$(".echo_item").html(a),$(".echo_item a").on("click",function(){var i=$(this).attr("href").split("=")[1],a=e[$(this).attr("rel")].num;null==window.sessionStorage.getItem("act_num"+i)&&(sea_updatenum(i,a),window.sessionStorage.setItem("act_num"+i,a))})})}activity_sea(),sea_activity_search(),sea_input_color(),sea_each_item();